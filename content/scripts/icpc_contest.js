const reference = [
  {
    "hour": 0,
    "min": 38, 
    "header": "Hell yeah!! Team 1 Solved problem C!",
    "images": [
        "balloon.jpg"
    ],
    "icon": "bi-alarm",
    "iconColor": "cornflowerblue", 
    "description": "They are lead AuIsDa by one problem solved but by penalty!!!"
  },
  {
    "hour": 0,
    "min": 39, 
    "header": "Hell yeah!! Team 2 Solved problem C!",
    "images": [
        "team2.png"
    ],
    "icon": "bi-alarm",
    "iconColor": "cornflowerblue", 
    "description": "CPM Soc member dilivering balloons!!!"
  },
  {
    "hour": 0,
    "min": 44, 
    "header": "Hell yeah!! Team 3 Solved problem A!",
    "images": [],
    "icon": "bi-alarm",
    "iconColor": "cornflowerblue", 
    "description": "CPM Soc member dilivering balloons!!!"
  },
  {
    "hour": 2,
    "min": 45, 
    "header": "15 Minute Left!!!!",
    "images": [],
    "icon": "bi-hourglass-split",
    "iconColor": "red", 
    "description": "CPM Soc member give warning!!!"
  },
  {
    "hour": 3,
    "min": "00", 
    "header": "Times Up!!!",
    "images": [],
    "icon": "bi-alarm",
    "iconColor": "", 
    "description": "Contest has ended, winner is from University Of Mars!!!"
  }
]

const liveObject = [
  {
    "hour": "0",
    "min": "00", 
    "header": "Contest Started!!!",
    "images": [],
    "icon": "bi-alarm",
    "iconColor": "", 
    "description": "It is now 12:00 and the contest has officially started! The first few minutes will mainly be a test of how fast the teams can read and type, and the first solve will come shortly."
  },
  {
    "hour": "0",
    "min": "06", 
    "header": "First Solve!!!",
    "images": ["balloonFirstPost.jpg"],
    "icon": "bi-balloon",
    "iconColor": "", 
    "description": "We have our first solve! Congratulations <em>Hell Hunt</em> from UNSW for solving problem A: A Menace 2 $ociety. They managed to solve it on their first go in only 6 minutes. Hell Hunt were our divisional champions, taking the first place, so they are no strangers to solving problems quickly. As per tradition, teams receive a balloon for each problem solved with different colours representing each problem. Additionally, a special balloon is given to the team that solves the first problem overall in the contest. There is only one such coloured balloon (rose gold) given throughout the entire contest. Congratulations Hell Hunt!"
  },
  {
    "hour": "0",
    "min": "15", 
    "header": "15 Minutes Passed!!!",
    "images": [],
    "icon": "bi-blockquote-left",
    "iconColor": "", 
    "description": `We have a few more solves! Team <em>cflat</em> from The University of Canterbury has made their first solve - problem B: Begrudging Friendship 2. They are the first team to solve this problem, 9 minutes into the contest. A minute later, it was also solved by <em>Hell Hunt</em> (UNSW). UNSW Magenta and <em>e</em> (USyd) also solved it, both on their second try.
    <br><br>
    Calloc (Auckland) made their first solve on problem I: Iguana Honeymoon. This may look like an unusual choice, but the problems are not in order of difficulty. A few minutes later, <em>Arts Students</em> (Melbourne) and <em>cflat</em> (Canterbury) have also solved it.
    <br><br>
    We asked <em>cflat</em> earlier about their team name, and they said it's a pun on the programming language C sharp (interview attached).
    <iframe width="560" height="315" src="https://www.youtube.com/embed/1urDkNQVZiU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    `
  },
  {
    "hour": "0",
    "min": "20", 
    "header": "20 Minutes into the contest!!!",
    "images": ["snedingOutBalloon1.jpg"],
    "icon": "bi-blockquote-left",
    "iconColor": "", 
    "description": `20 minutes into the contest and 8 out of 10 teams have solved problem B. This problem is by far the most solved so far.The next most-solved problem is problem I with 4 solves by <em>cflat</em> (Canterbury), <em>Arts Students</em> (Melbourne), <em>Nunchuck Crunchers</em> (Sydney) and <em>Calloc</em> (Auckland). Surprisingly, <em>Hell Hunt</em> who are leading the scoreboard at this time have not submitted anything for problem I. It seems that they are solving the problems in order. They have solved 3 problems: A, then B, then C. They are the only team at this point to have solved three problems.`
  },
  {
    "hour": "0",
    "min": "32", 
    "header": "Hell Hunt in the lead!!!",
    "images": [],
    "icon": "bi-flag",
    "iconColor": "", 
    "description": `<em>Hell Hunt</em> has made yet another solve, for a total of 4 solves! They are leading the scoreboard right now, with the next four teams having solved two problems.<br><br>Problem I has now been solved by 6 out of the 10 teams. Hell Hunt, who is currently first placed, have still yet to solve it.`
  },
  {
    "hour": "0",
    "min": "45", 
    "header": "45 Minutes Into the Contest!!!",
    "images": [],
    "icon": "bi-clock",
    "iconColor": "", 
    "description": `<em>Yakult on Tap</em> (Western Australia) have made their first solve which pushed them from 10th to 9th, surpassing <em>Myles and noobs</em> (Adelaide). Now <em>Myles and noobs</em> have actually made their first solve before <em>Yakult on Tap</em>, so you might be wondering why a team that has solved one problem later on in the contest is beating another team that also has one solve? This is becausethe ICPC ranks teams not just on number of solves and time, but also adds on a time penalty for incorrect submissions. Hence, teams must rigorously test their code and be confident that their solutions are correct before submitting if they do not want to be penalised.<br><br>
    Both problem B and I have been solved by 9 out of 10 teams. <em>Hell Hunt</em> is still leading the scoreboard with 5 solves, followed by <em>Nunchuck Crunchers</em>, <em>Arts Students</em> and <em>AnIsDa</em> with three solves each. <em>AnIsDa's</em> solves in the past 5 minutes have brought their rank up quite a bit.`
  },
  {
    "hour": "0",
    "min": "58", 
    "header": "Contestant work hard on problems!!!",
    "images": ["contestant2.jpg","contestant3.jpg", "contestant4.jpg", "contestant5.jpg", "contestant6.jpg"],
    "icon": "bi-question-circle",
    "iconColor": "", 
    "description": ``
  },
  {
    "hour": "1",
    "min": "00", 
    "header": "Problem I",
    "images": [],
    "icon": "bi-question-circle",
    "iconColor": "", 
    "description": `
    Problem I has now been solved by all teams! This surpasses problem B (with 9 out of 10 solves). This difference didn't stay for long, with a solve of problem B by Yakult on Tap. Problem B has now been solved by all teams as well. The time difference between these two problems is only 1 minute. Problem I was solved by all teams in 54 minutes, and problem B in 55 minutes.`
  },
  {
    "hour": "1",
    "min": "06", 
    "header": "AnIsDa on fire!!!!",
    "images": ["balloonSecondPost.jpg", "balloonAngus.jpg"],
    "icon": "bi-fire",
    "iconColor": "", 
    "description": `
    <em>AnIsDa</em> have risen yet again to second place with their latest solve of problem E at 58 minutes. They were also the first team to solve problem G at 60 minutes. The top two teams are now <em>Hell Hunt</em> (who have maintained the top spot throughout the first hour) and <em>AnIsDa</em>. Both teams are from UNSW. It will be a tight competition between these two teams because they are fighting for a spot at the World Finals. These spots go to the top two teams, but they cannot be from the same university! So at most one of those two teams can go, even if they both place in the top two.`
  },
  {
    "hour": "1",
    "min": "12", 
    "header": "Commentary",
    "images": [],
    "icon": "bi-question-circle",
    "iconColor": "", 
    "description": `It seems like problem C: Cakes and Ogres is the next easiest with 6 solves out of the 10 teams. Problem C may seem difficult but a look at the bounds suggests a simple brute-force of all the permutations of cakes could work.`
  },
  {
    "hour": "1",
    "min": "22", 
    "header": "Myles and noobs have made a comeback, rising from last place to fifth with their solve of problem C at 72 minutes.",
    "images": ["balloonC.jpg"],
    "icon": "bi-bell",
    "iconColor": "", 
    "description": `There is a difference of one solve between the top 5 teams: Rank 1 (<em>Hell Hunt</em>) has 7 solves, rank 2 (<em>AnIsDa</em>) has 6 solves, rank 3 (<em>Arts Students</em>) has 5 solves, rank 4 (<em>Nunchuck Crunchers</em>) has 4 solves and e has 3 solves.`
  },
  {
    "hour": "1",
    "min": "58", 
    "header": "Lunches Arrives for Mirror Competition",
    "images": ["mirror.jpg","mirror1.jpg","mirror2.jpg","mirror3.jpg","mirror4.jpg"],
    "icon": "bi-bell",
    "iconColor": "", 
    "description": `Whilst our official contestants are competing on the ground floor, we are also running a mirror contest upstairs on level 3. The mirror contest contains the exact same problems and allows students who did not qualify for the regionals to still participate unofficially. `
  },
  {
    "hour": "2",
    "min": "00", 
    "header": "Commentary",
    "images": [],
    "icon": "bi-clock",
    "iconColor": "", 
    "description": `We are now 2 hours into the 5 hour contest. The past 30 minutes have been a lot slower with only 7 solves. Three of these were for problem L: Land Tax, two for problem E and one solve for problems C and G.`
  },
  {
    "hour": "2",
    "min": "22", 
    "header": "Commentary",
    "images": [],
    "icon": "bi-question-circle",
    "iconColor": "", 
    "description": `It's almost half way into the contest. <em>AnIsDa</em> and <em>Arts Students</em> have caught up to <em>Hell Hunt</em> in the number of problems solved, although their ranks remain the same (first, second and third respectively). This is because teams with the same number of solves are ranked by time (and time penalties). The top three teams have now solved eight problems each.`
  },
  {
    "hour": "2",
    "min": "30", 
    "header": "Half way through",
    "images": [],
    "icon": "bi-question-circle",
    "iconColor": "", 
    "description": `We are now half way through the contest and <em>Hell Hunt</em> have solved another problem. They have three more problems to solve to get a full solve. These last three problems are significantly harder, so we expect their pace will slow down a lot. Interestingly, one of the members of <em>Hell Hunt</em> is participating remotely, joining in their team members (and the inviligators) over a Zoom call.<br><br>
    To preserve the integrity of the contest, the judges have removed the keyboard of Hell Hunt's onsite representatives. Teams are only allowed to use one keyboard and use one computer (so all coding and debugging must be done on the one machine) so teams have to be efficient with their time on the computer. To help with this, teams are able to print out their code by copying their code onto a USB provided by our volunteers. Our volunteers then run this print job for them. The teams can then debug their code on paper, freeing up the computer to be used by another team member.
    <br><br>
    Since <em>Hell Hunt</em> do not have this luxury of taking turns on the keyboards, their only strategy is for the onsite team members to communicate their ideas and strategies over to their remote team mate to implement and submit. This is extremely impressive in itself, not withstanding that they are coming first.
    `
  },
  {
    "hour": "3",
    "min": "00", 
    "header": "Mirror Contests Teams",
    "images": ["mirrorP1.jpg", "mirrorP2.jpg", "mirrorP3.jpg", "mirrorP4.jpg", "mirrorP5.jpg", "mirrorP6.jpg", "mirrorP7.jpg", "mirrorP8.jpg", "mirrorP9.jpg", "mirrorP10.jpg", "mirrorP11", "mirrorP12.jpg", "mirrorP13.jpg", "mirrorP14.jpg", "mirrorP15.jpg"],
    "icon": "bi-fire",
    "iconColor": "", 
    "description": ``
  },
  {
    "hour": "3",
    "min": "08", 
    "header": "More Mirror Contests Teams",
    "images": ["mirrorP16.jpg"],
    "icon": "bi-fire",
    "iconColor": "", 
    "description": ``
  }, {
    "hour": "3",
    "min": "23", 
    "header": "Fun fact of question B",
    "images": ["questionB.png"],
    "icon": "bi-book",
    "iconColor": "", 
    "description": `Fun fact: Problem B is named "Begrudging Friendship 2" suggesting there is a part 1. In the Divisionals held a few months ago, we learned about Kylie and Leonard's friendship in the problem "Begrudging Frinedship" (question attached). In that problem, they went to buy drinks with Kyle choosing the drinks such that the level of pettiness (defined in the problem) is maximised. In today's contest, it's Leonard's turn to choose meals for dinner, such that his pettiness value is maximised. Whilst both problems have a similar flavour text and story, they are still different problems.`
  }, 
  {
    "hour": "3",
    "min": "59", 
    "header": "Arts Student Have a Chance of Coming First",
    "images": [],
    "icon": "bi-fire",
    "iconColor": "", 
    "description": `<em>Arts Students</em> have solved their 9th problem, moving them up to second place. This is their first solve in over 100 minutes. This pushes </em>AnIsDa</em> down to third place, increasing the gap between <em>Hell Hunt</em> and <em>AnIsDa</em>. Remember both teams are from UNSW and only one of them can go to the World Finals. If <em>AnIsDa</em> is to make the World Finals, they have to solve at least 3 more problems in the remaining hour.`
  }, 
  {
    "hour": "4",
    "min": "00", 
    "header": "Final Hour",
    "images": [],
    "icon": "bi-hourglass-split",
    "iconColor": "", 
    "description": "It's now the final hour of the contest and the scoreboards have frozen and our volunteers have stopped running (walking) balloons to the teams. If you've never been to an ICPC contest before, teams are given a balloon for each problem they solve, with different coloured balloons for different problems. The scoreboards are frozen during the last hour to create some more suspense. The solves and changes in ranking within the last hour will be revealed during the closing ceremony."
  }, 
  {
    "hour": "4",
    "min": "10", 
    "header": "Final Hour!!!",
    "images": ["contest1.jpg", "contest2.jpg", "contest3.jpg", "contest4.jpg", "contest6.jpg", "contest7.jpg", "contest8.jpg", "contest9.jpg", "contest10.jpg", "contest11.jpg"],
    "icon": "bi-fire",
    "iconColor": "red", 
    "description": ""
  },  
  {
    "hour": "4",
    "min": "10", 
    "header": "Final Hour!!!",
    "images": ["contestFull1.jpg", "contestFull2.jpg", "contestFull3.jpg"],
    "icon": "bi-fire",
    "iconColor": "red", 
    "description": ""
  },   
  {
    "hour": "4",
    "min": "50", 
    "header": "Top 3 Teams At the Last 10 Minutes!!!",
    "images": ["top31.jpg", "top33.jpg", "top32.jpg"],
    "icon": "bi-fire",
    "iconColor": "red", 
    "description": `
    We are now in the last 10 minutes of the contest and we have some photos from the top three teams at the time of the scoreboard freezing. Recall that the scoreboard freezes during the final hour and any information about successful solves are hidden from other teams. Of course, a team will know if they have solved their own submission.
    <br>
    1. Hell Hunt<br>
    2. Arts Students<br>
    3. AnIsDa`
    <br>
    During the last hour, all these teams have made additional submissions so the top three spots could still go either way. Hell Hunt have made two more submissions to their remaining two problems. If they manage to solve these two problems, they would have solved the full set of problems. Arts Students have also made submissions to all the remaining problems, so either Hell Hunt or Arts Students have the chance of taking the top spot if these submissions are successful.
    <br><br>
    AnIsDa have two unsolved problems, and made submissions to problem H but not F. For them to qualify for the World Finals, this submission needs to be successful whilst Hell Hunt's two remaining submissions needs to be unsuccessful.<br><br>

    Either way, Arts Students are almost certain to make the World Finals. The only way this could change is if the next ranked team solves over four problems in the last few minutes. The remaining World Finals spot could still go to either the two UNSW teams.
  }, 
  {
    "hour": "5",
    "min": "10", 
    "header": "Public Editorials Released",
    "images": [],
    "icon": "bi-youtube",
    "iconColor": "red", 
    "description": `Our head judge, Max Ward, goes through all of today's problems. Videos are available at
    <a href="https://www.youtube.com/playlist?list=PLRzSI_wBzwQv2AcNh8hJBJZupuyTgOtbj">https://www.youtube.com/playlist?list=PLRzSI_wBzwQv2AcNh8hJBJZupuyTgOtbj</a>
    `
  }, 
]

const contestStartTime = new Date('2022-12-17T12:00:00')
const contestEndTime = new Date('2022-12-17T17:00:00')

/**
 * We might want to put newest event at the top
 */
function loadSingleEvent(event) {
  function loadEventStart(event) {
    return `<div class="border border-success p-2 border-opacity-10" role="alert">`;
  }

  function loadEventEnd(event) {
    return `</div><br>`;
  }

  function loadTimeTitle(event) {
    return `<p style="
      font-family: 'Courier New', monospace;
      font-size: 130%;
      font-weight: bold;
      padding: 0;
      margin: 0;
    ">
    <i class="bi ${event.icon}" style="font-size: 2rem; color: ${event.iconColor};">
    </i>[${event.hour}:${event.min}]</p> 
    <h5 style="
      margin-left: 2.7em;
      font-size: 140%;
      color: #ab8361;
    "
    ">${event.header}
    </h5>`;
  }

  function loadImage(event) {
    let imgStr = "";
    if (event.images.length > 0) {
      for (let imgPath of event.images) {
        imgStr += `<img class="mx-auto" src="/assets/icpc/${imgPath}">`;
      }
    }
    return imgStr;
  }

  function loadVideo(event) {
    if (event.video === undefined) return "";
    return event.video;
  }

  function loadDescription(event) {
    return `<p style="margin-left: 4.8em;">${event.description}</p><br>`;
  }

  var div = document.createElement("div");
  
  var htmlStr = loadEventStart(event);
  htmlStr += loadTimeTitle(event);
  htmlStr += loadImage(event);
  htmlStr += loadVideo(event);
  htmlStr += loadDescription(event);
  htmlStr += loadEventEnd(event);

  div.innerHTML = htmlStr;

  // Load into html
  document.getElementById("live-section").appendChild(div);
}

/**
 * html for contest loading animation
 */
function loadingStart() {
  document.getElementById("loading-bar").innerHTML = `
    <div class="alert alert-success" role="alert">
      <h4 class="alert-heading">Welcome to the Live Blog!!!</h4>
      <p>Aww yeah, you are at the right place.</p>
      <hr>
      <div class=" d-flex align-items-center">
        The contest will starts at ${contestStartTime.toTimeString()}!
        <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div>
      </div>
    </div>
  `;
}

/**
 * html for the progess
 */
function loadingProgress() {

  let progess = Math.abs(contestEndTime.getTime() - Date.now()) / (contestEndTime.getTime() - contestStartTime.getTime());
  progess *= 100;
  progess = Math.floor(progess);
  console.log(progess);

  document.getElementById("loading-bar").innerHTML = `
    <div class="progress">
      <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-label="Animated striped example" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 80%"></div>
    </div><br>
  `;
}


if (liveObject.length == 0) {
  loadingStart();
} else {
  loadingProgress();
  for (let event of liveObject.reverse()) {
    loadSingleEvent(event);
  }
}
